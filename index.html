<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Pronk Mobilize</title>

  <script>
    // Read all TMS parameters dynamically
    const params = new URLSearchParams(window.location.search);

    // Build dynamic portion from TMS
    const passthrough = [];
    for (const [key, value] of params.entries()) {
      if (key.toLowerCase() !== "autotest") {
        passthrough.push(`${encodeURIComponent(key)}=${encodeURIComponent(value)}`);
      }
    }

    // Required fixed autotest block
    const autotestBlock =
      '{"NFPA992012APwGND","2sec,Rpt,PwrEnd,A","GndRes,500","NP:CL:NC,100","NP:CL:OG,500","NP:LLG:NC,100","NP:LLG:OG,500"}';

   // Final deep link for Pronk Mobilize
let pronkUrl = "pronk://open?devtype=json";

if (passthrough.length > 0) {
  pronkUrl += "&" + passthrough.join("&") + "&autotest=" + autotestBlock;
} else {
  pronkUrl += "&autotest=" + autotestBlock;
}


    // Trigger the deep link via a user-click simulation
    function launch() {
      const a = document.createElement('a');
      a.href = pronkUrl;
      a.style.display = "none";
      document.body.appendChild(a);
      a.click();  // Browser counts this as a user gesture → Pronk launches
    }

    // Launch as soon as the page is ready
    window.onload = function () {
      launch();

      // Auto-close the window (TMS popup goes away)
      setTimeout(() => window.close(), 600);
    };
  </script>

</head>
<body>
  <p style="font-family: sans-serif;">Launching Pronk Mobilize…</p>
</body>
</html>
